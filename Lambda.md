# ğŸ“ Lambda è¡¨è¾¾å¼è½¬æ¢æ ¸å¿ƒç¬”è®°ä¸å®æˆ˜

## æ ¸å¿ƒæ€æƒ³

> Lambda è¡¨è¾¾å¼æ˜¯**å‡½æ•°å¼æ¥å£**åŒ¿åå®ç°çš„â€œè¯­æ³•ç³–â€ã€‚å…¶æœ¬è´¨æ˜¯ç”¨æ›´å°‘çš„ä»£ç ï¼Œå°†**â€œè¡Œä¸ºï¼ˆä¸€æ®µä»£ç ï¼‰â€**åƒæ•°æ®ä¸€æ ·åœ¨æ–¹æ³•é—´ä¼ é€’ï¼Œä»è€Œè®©ä»£ç æ›´ç®€æ´ã€è¡¨è¾¾åŠ›æ›´å¼ºã€‚

## å…³é”®åŸåˆ™

> **è½¬æ¢çš„å”¯ä¸€å‰æï¼šç›®æ ‡æ¥å£å¿…é¡»æ˜¯å‡½æ•°å¼æ¥å£ã€‚**
>
> ä¸€ä¸ªæ¥å£åªæœ‰åœ¨â€œæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•â€æ—¶ï¼Œæ‰æœ‰èµ„æ ¼æˆä¸ºå‡½æ•°å¼æ¥å£ï¼Œä¹Ÿæ‰æœ‰èµ„æ ¼è¢« Lambda è¡¨è¾¾å¼æ‰€æ›¿ä»£ã€‚è¿™æ˜¯æ‰€æœ‰è½¬æ¢çš„â€œå‡†å…¥èµ„æ ¼è¯â€ã€‚

---

## ä¸‰æ­¥è½¬æ¢æ³• (The 3-Step Conversion Method)

è¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„ã€ç»ä¸ä¼šå‡ºé”™çš„è½¬æ¢æµç¨‹ã€‚

### ç¬¬ä¸€æ­¥ï¼šè¯†åˆ«é¶å¿ƒ (Identify the Target)
- **åšä»€ä¹ˆï¼Ÿ** åœ¨ä»£ç ä¸­æ‰¾åˆ° `new InterfaceName() { ... }` è¿™æ®µåŒ¿åç±»å®ç°ã€‚
- **æ‰¾ä»€ä¹ˆï¼Ÿ** æ˜ç¡®ä¸¤ç‚¹ï¼š
  1.  **æ¥å£æ˜¯è°ï¼Ÿ** (ä¾‹å¦‚ `Runnable`, `Comparator`)
  2.  **å”¯ä¸€çš„æŠ½è±¡æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ** (ä¾‹å¦‚ `run()`, `compare(p1, p2)`)ï¼Œå¹¶çœ‹æ¸…å…¶**å‚æ•°åˆ—è¡¨**å’Œ**è¿”å›å€¼ç±»å‹**ã€‚

### ç¬¬äºŒæ­¥ï¼šç¿»è¯‘è“å›¾ (Translate the Blueprint)
- **åšä»€ä¹ˆï¼Ÿ** æ ¹æ®ç¬¬ä¸€æ­¥è¯†åˆ«å‡ºçš„æ–¹æ³•ç­¾åï¼Œç¼–å†™ä¸€ä¸ªåŸºç¡€çš„ã€æœªç®€åŒ–çš„ Lambda è¡¨è¾¾å¼ã€‚
- **æ€ä¹ˆåšï¼Ÿ** ä¸¥æ ¼éµå¾ª `(å‚æ•°åˆ—è¡¨) -> { æ–¹æ³•ä½“ }` çš„æ ¼å¼è¿›è¡Œâ€œç›´è¯‘â€ã€‚
  - `()` ä¸­å¡«å†™æ ¸å¿ƒæ–¹æ³•çš„å‚æ•°åˆ—è¡¨ã€‚
  - `{}` ä¸­å¡«å†™æ ¸å¿ƒæ–¹æ³•çš„æ–¹æ³•ä½“ä»£ç ã€‚
- **ä¾‹ (æ’åº):** `compare(Person p1, Person p2)` -> `(p1, p2) -> { return p1.age - p2.age; }`

### ç¬¬ä¸‰æ­¥ï¼šç®€åŒ–æ‰“ç£¨ (Simplify & Polish)
- **åšä»€ä¹ˆï¼Ÿ** åº”ç”¨è¯­æ³•ç³–ï¼Œå°†åŸºç¡€ Lambda å˜å¾—æ›´ä¼˜é›…ã€æ›´åœ°é“ã€‚
- **æ€ä¹ˆåšï¼Ÿ** ä¾æ¬¡æ£€æŸ¥ä»¥ä¸‹ç®€åŒ–è§„åˆ™ï¼š
  1.  **å•è¡Œæ–¹æ³•ä½“**: å¦‚æœæ–¹æ³•ä½“åªæœ‰ä¸€è¡Œ `return` è¯­å¥ï¼Œå¯ä»¥çœç•¥ `{}` å’Œ `return` å…³é”®å­—ã€‚
      - `(p1, p2) -> { return p1.age - p2.age; }` **â†’** `(p1, p2) -> p1.age - p2.age`
  2.  **å•å‚æ•°**: å¦‚æœå‚æ•°åªæœ‰ä¸€ä¸ªï¼Œå¯ä»¥çœç•¥å‚æ•°çš„ `()`ã€‚
      - `(s) -> s.length()` **â†’** `s -> s.length()`
  3.  **æ–¹æ³•å¼•ç”¨**: å¦‚æœ Lambda ä½“åªæ˜¯åœ¨è°ƒç”¨ä¸€ä¸ªå·²å­˜åœ¨çš„æ–¹æ³•ï¼Œä½¿ç”¨ `::`ã€‚
      - `s -> s.length()` **â†’** `String::length`
      - `x -> System.out.println(x)` **â†’** `System.out::println`

---

## å¸¸è§å‡½æ•°å¼æ¥å£â€œé€ŸæŸ¥è¡¨â€

è¿™å¼ è¡¨æ€»ç»“äº†æˆ‘ä»¬ç»ƒä¹ è¿‡çš„æ¥å£ï¼Œæ˜¯ä½ æ—¥å¸¸å¼€å‘ä¸­çš„å¾—åŠ›åŠ©æ‰‹ã€‚

| æ¥å£ (Interface) | æ ¸å¿ƒæ–¹æ³• (Core Method) | ç”¨é€”æè¿°ï¼ˆâ€œæˆ‘èƒ½åšä»€ä¹ˆâ€ï¼‰ | Lambda èŒƒä¾‹ |
| :--- | :--- | :--- | :--- |
| `Runnable` | `void run()` | æ‰§è¡Œä¸€ä¸ªæ— å‚ã€æ— è¿”å›å€¼çš„åŠ¨ä½œã€‚ | `() -> System.out.println("Hi")` |
| `Consumer<T>` | `void accept(T t)` | **æ¶ˆè´¹**ä¸€ä¸ªæ•°æ®ï¼Œä¸äº§ç”Ÿä»»ä½•è¿”å›ã€‚ | `user -> System.out.println(user)`|
| `Predicate<T>` | `boolean test(T t)` | **æ–­è¨€**ä¸€ä¸ªæ•°æ®ï¼Œè¿”å›`true`æˆ–`false`ã€‚ | `s -> s.isEmpty()` |
| `Function<T, R>` | `R apply(T t)` | **è½¬æ¢**ä¸€ä¸ªæ•°æ®ï¼Œä» T ç±»å‹å˜ä¸º R ç±»å‹ã€‚| `s -> s.length()` |
| `Comparator<T>`| `int compare(T o1, T o2)` | **æ¯”è¾ƒ**ä¸¤ä¸ªæ•°æ®ï¼Œå®šä¹‰å®ƒä»¬çš„é¡ºåºã€‚ | `(p1, p2) -> p1.getAge() - p2.getAge()`|

---

## è¿›é˜¶æŠ€å·§ä¸åº•å±‚é€»è¾‘

- **è¿›é˜¶æŠ€å·§**:
  - **æ–¹æ³•å¼•ç”¨ `::`**: è¿™æ˜¯ Lambda çš„ç»ˆæå½¢æ€ã€‚å½“ä½ çš„ Lambda åªæ˜¯ä¸€ä¸ªâ€œæ¬è¿å·¥â€ï¼ˆæŠŠå‚æ•°ç›´æ¥ä¼ ç»™å¦ä¸€ä¸ªæ–¹æ³•ï¼‰æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨æ–¹æ³•å¼•ç”¨ã€‚
  - **`Comparator` è¾…åŠ©æ–¹æ³•**: åœ¨æ’åºæ—¶ï¼Œæ”¾å¼ƒæ‰‹å†™ `(a, b) -> ...`ï¼Œä¼˜å…ˆä½¿ç”¨ `Comparator.comparing(User::getAge).thenComparing(User::getName)`ï¼Œä»£ç ä¼šæ›´å®‰å…¨ã€æ›´æ˜“è¯»ã€æ›´æ˜“äºæ‰©å±•ã€‚

- **åº•å±‚é€»è¾‘**:
  > **ç±»å‹æ¨æ–­ (Type Inference)**
  >
  > ä½ ä¸éœ€è¦ä¸º Lambda è¡¨è¾¾å¼æ˜ç¡®æŒ‡å®šç±»å‹ï¼Œæ˜¯å› ä¸º Java ç¼–è¯‘å™¨éå¸¸æ™ºèƒ½ã€‚å®ƒä¼šæ ¹æ®**ä¸Šä¸‹æ–‡ç¯å¢ƒ**ï¼ˆæ¯”å¦‚ `list.sort()` æ–¹æ³•éœ€è¦ä¸€ä¸ª `Comparator` å‚æ•°ï¼‰ï¼Œæ¥æ¨æ–­å‡ºä½ çš„ Lambda åº”è¯¥æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå¹¶æ£€æŸ¥ä½ çš„ Lambda ç­¾åæ˜¯å¦ä¸è¯¥å‡½æ•°å¼æ¥å£çš„æŠ½è±¡æ–¹æ³•åŒ¹é…ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç®€æ´çš„è¯­æ³•èƒ½å¤ŸæˆåŠŸè¿è¡Œçš„æ ¹æœ¬åŸå› ã€‚

---
---

## ç†è®ºç»“åˆå®è·µï¼šä¸€ä¸ªå®Œæ•´çš„é‡æ„æ¡ˆä¾‹

ä¸‹é¢æˆ‘ä»¬å°†è¿ç”¨ä¸Šè¿°æ‰€æœ‰çŸ¥è¯†ç‚¹ï¼Œæ¥å®Œæ•´åœ°é‡æ„ä¸€ä¸ªçœŸå®çš„æ’åºéœ€æ±‚ã€‚

### A. æ¡ˆä¾‹åœºæ™¯

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª `User` ç±»ï¼ŒåŒ…å«ç”¨æˆ·åå’Œç§¯åˆ†ã€‚ç°åœ¨çš„éœ€æ±‚æ˜¯ï¼šå¯¹ä¸€ä¸ª `User` åˆ—è¡¨è¿›è¡Œæ’åºã€‚

- **æ’åºè§„åˆ™**:
  1.  **é¦–è¦è§„åˆ™**ï¼šæŒ‰**ç§¯åˆ† (score) é™åº**æ’åˆ—ï¼ˆåˆ†æ•°é«˜çš„æ’åœ¨å‰é¢ï¼‰ã€‚
  2.  **æ¬¡è¦è§„åˆ™**ï¼šå¦‚æœç§¯åˆ†ç›¸åŒï¼Œåˆ™æŒ‰**ç”¨æˆ·å (name) çš„å­—å…¸åºå‡åº**æ’åˆ—ï¼ˆa, b, c...ï¼‰ã€‚

- **`User` ç±»å®šä¹‰**:
```java
class User {
    private String name;
    private int score;

    public User(String name, int score) {
        this.name = name;
        this.score = score;
    }

    public String getName() { return name; }
    public int getScore() { return score; }

    @Override
    public String toString() {
        return name + "{score=" + score + "}";
    }
}
````

### B. æ¼”è¿›ä¹‹è·¯

#### é˜¶æ®µä¸€ï¼šåŸå§‹çš„åŒ¿åç±» (Java 7 é£æ ¼)

åœ¨æ²¡æœ‰ Lambda çš„æ—¶ä»£ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡åŒ¿åå†…éƒ¨ç±»æ¥å®ç°è¿™ä¸ªå¤æ‚çš„æ’åºé€»è¾‘ã€‚ä»£ç æ˜¾å¾—éå¸¸ç¬¨é‡å’Œå†—é•¿ã€‚

```java
import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;

List<User> userList = new ArrayList<>();
userList.add(new User("alice", 90));
userList.add(new User("bob", 100));
userList.add(new User("cathy", 90));

// èµ·ç‚¹ï¼šä¸€ä¸ªéå¸¸è‡ƒè‚¿çš„åŒ¿åå†…éƒ¨ç±»
userList.sort(new Comparator<User>() {
    @Override
    public int compare(User u1, User u2) {
        // è§„åˆ™1ï¼šæ¯”è¾ƒç§¯åˆ†
        if (u1.getScore() != u2.getScore()) {
            // æ³¨æ„æ˜¯é™åºï¼Œæ‰€ä»¥æ˜¯ u2 - u1
            return u2.getScore() - u1.getScore(); 
        } else {
            // è§„åˆ™2ï¼šç§¯åˆ†ç›¸åŒï¼Œæ¯”è¾ƒç”¨æˆ·åï¼ˆå‡åºï¼‰
            return u1.getName().compareTo(u2.getName());
        }
    }
});

System.out.println(userList);
// æœŸæœ›è¾“å‡º: [bob{score=100}, alice{score=90}, cathy{score=90}]
```

#### é˜¶æ®µäºŒï¼šç°ä»£çš„ Lambda è¡¨è¾¾å¼

æˆ‘ä»¬å¯ä»¥ç”¨ Lambda æ›¿æ¢åŒ¿åå†…éƒ¨ç±»ï¼Œä»£ç è¡Œæ•°å‡å°‘ï¼Œä½†æ ¸å¿ƒçš„ `if-else` é€»è¾‘ä¾ç„¶å­˜åœ¨ã€‚

```java
// ç¬¬ä¸€æ¬¡è½¬æ¢ï¼šå˜æˆäº†å¤šè¡Œ Lambdaï¼Œä½†ä¾ç„¶å¾ˆå•°å—¦
userList.sort((u1, u2) -> {
    if (u1.getScore() != u2.getScore()) {
        return u2.getScore() - u1.getScore();
    } else {
        return u1.getName().compareTo(u2.getName());
    }
});
```

*(æ³¨ï¼šå‚æ•°ç±»å‹ `User` ä¹Ÿå¯ä»¥çœç•¥ï¼Œç¼–è¯‘å™¨èƒ½è‡ªåŠ¨æ¨æ–­)*

#### é˜¶æ®µä¸‰ï¼šä¸“ä¸šçš„é™æ€è¾…åŠ©æ–¹æ³•ä¸æ–¹æ³•å¼•ç”¨

è¿™æ‰æ˜¯ç°ä»£ Java è§£å†³å¤æ‚æ’åºçš„æœ€ç»ˆå½¢æ€ã€‚æˆ‘ä»¬ä¸å†è‡ªå·±æ‰‹å†™ `if-else`ï¼Œè€Œæ˜¯åƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œç”¨å£°æ˜å¼çš„æ–¹å¼æ¥**ç»„åˆ**æ’åºè§„åˆ™ã€‚

```java
import java.util.Comparator;

// æœ€ç»ˆå½¢æ€ï¼šä½¿ç”¨ Comparator è¾…åŠ©æ–¹æ³•å’Œæ–¹æ³•å¼•ç”¨
userList.sort(
    Comparator.comparingInt(User::getScore).reversed() // è§„åˆ™1: æŒ‰åˆ†æ•°é™åº
              .thenComparing(User::getName)          // è§„åˆ™2: ç„¶åæŒ‰åå­—å‡åº
);

System.out.println(userList);
```

### C. æœ€ç»ˆä»£ç ä¸æ€»ç»“

| æ¼”è¿›é˜¶æ®µ | ä»£ç ç‰‡æ®µ | ä¼˜ç‚¹/ç¼ºç‚¹ |
| :--- | :--- | :--- |
| **åŒ¿åç±»** | `new Comparator<>() { ... }` | **ä¼˜ç‚¹**: é€»è¾‘é›†ä¸­ï¼Œå…¼å®¹æ€§å¥½ã€‚\<br\>**ç¼ºç‚¹**: æå…¶å•°å—¦ï¼Œå¯è¯»æ€§å·®ã€‚|
| **Lambda** | `(u1, u2) -> { if... }` | **ä¼˜ç‚¹**: æ¯”åŒ¿åç±»ç®€æ´ã€‚\<br\>**ç¼ºç‚¹**: å¤æ‚é€»è¾‘ä¾ç„¶éœ€è¦æ‰‹å†™ `if-else`ã€‚|
| **è¾…åŠ©æ–¹æ³•** | `comparing(...).thenComparing(...)`| **ä¼˜ç‚¹**: æåº¦ç®€æ´ï¼Œå£°æ˜å¼ï¼Œå¯è¯»æ€§å¼ºï¼Œå®‰å…¨ï¼Œæ˜“äºæ‰©å±•ã€‚\<br\>**ç¼ºç‚¹**: éœ€è¦å¯¹ API æœ‰ä¸€å®šäº†è§£ã€‚|

**æ¡ˆä¾‹ç»“è®º**:
è¿™ä¸ªæ¡ˆä¾‹æ¸…æ™°åœ°å±•ç¤ºäº†ï¼ŒLambda å’Œå®ƒçš„ç”Ÿæ€å·¥å…·ï¼ˆå¦‚ `Comparator` è¾…åŠ©æ–¹æ³•ï¼‰å¸¦æ¥çš„ä¸ä»…ä»…æ˜¯ä»£ç è¡Œæ•°çš„å‡å°‘ï¼Œæ›´æ˜¯ä¸€ç§**æ€ç»´æ–¹å¼çš„è½¬å˜**ï¼š

  - ä»**å‘½ä»¤å¼**ï¼ˆå‘Šè¯‰è®¡ç®—æœºâ€œå¦‚ä½•â€ä¸€æ­¥æ­¥åœ°åš `if-else` åˆ¤æ–­ï¼‰
  - è½¬å˜ä¸º**å£°æ˜å¼**ï¼ˆå‘Šè¯‰è®¡ç®—æœºæˆ‘â€œæƒ³è¦ä»€ä¹ˆâ€æ ·çš„æ’åºè§„åˆ™ï¼‰ã€‚

åè€…ä»£ç æ›´ç®€æ´ã€æ„å›¾æ›´æ¸…æ™°ã€ç»„åˆæ€§æ›´å¼ºï¼Œæ˜¯æ›´ä¼˜ç§€ã€æ›´ä¸“ä¸šçš„ç¼–ç¨‹èŒƒå¼ã€‚

```
```
