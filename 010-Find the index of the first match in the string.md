å¥½çš„ï¼Œæˆ‘ä»¬è¿™å°±æŠŠè¿™é“ç»å…¸çš„ `strStr()` é—®é¢˜ï¼Œå’Œä½ åº”ç”¨ KMP ç®—æ³•çš„è¿™æ¬¡å®è´µå®è·µï¼Œä¸€èµ·æ²‰æ·€ä¸‹æ¥ã€‚

ä½ åœ¨å°è¯•ç”¨ä¸€ä¸ªæ›´é«˜çº§çš„ç®—æ³•æ¥è§£å†³ä¸€ä¸ªåŸºç¡€é—®é¢˜ï¼Œè¿™ä¸ªæ–¹å‘éå¸¸å¥½ã€‚è¿™æ¬¡çŠ¯çš„â€œæ¦‚å¿µæ€§â€é”™è¯¯ï¼Œä¼šè®©ï¼ˆ`next` æ•°ç»„ï¼‰çš„ç†è§£æ¯”çœ‹ä¹¦æ·±åˆ»ä¸€ç™¾å€ã€‚

-----

### **1. ä½ çš„ä»£ç åˆ†æï¼šä¸€ä¸ªå…³é”®çš„æ¦‚å¿µæ€§é”™è¯¯**

ä½ çš„ KMP ä»£ç æ¡†æ¶ï¼Œæ— è®ºæ˜¯ `buildNext` è¿˜æ˜¯ä¸»å¾ªç¯çš„ç»“æ„ï¼Œéƒ½å†™å¾—éå¸¸æ ‡å‡†ï¼Œè¿™è¯´æ˜ä½ å·²ç»è®°ä½äº† KMP ç®—æ³•çš„â€œå½¢â€ã€‚

ä½ é‡åˆ°çš„é—®é¢˜ï¼Œå‡ºåœ¨äº†å¯¹ KMP ç®—æ³•â€œç¥â€çš„ç†è§£ä¸Šï¼Œä¹Ÿå°±æ˜¯å®ƒ**é¢„å¤„ç†çš„å¯¹è±¡**ã€‚

**é”™è¯¯ä»£ç å›é¡¾ï¼š**

```java
// åœ¨ strStr æ–¹æ³•ä¸­...
// ã€é”™è¯¯ï¼ã€‘ï¼šnext æ•°ç»„åº”è¯¥æ ¹æ® needle æ¥æ„å»ºï¼Œè€Œä¸æ˜¯ haystack
int[] next = buildNext(haystack); 
```

**é”™è¯¯æ ¹æºï¼šâ€œé¢„æ¡ˆâ€åšé”™äº†å¯¹è±¡**
æˆ‘ä»¬å†å›é¡¾ä¸€æ¬¡â€œKMPç‰¹å·¥è¡ŒåŠ¨â€çš„æ•…äº‹ï¼š

  - `next` æ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯ç‰¹å·¥åœ¨å‡ºå‘å‰ï¼Œå¯¹è‡ªå·±è¦æ‰¾çš„é‚£ä¸ª\*\*â€œç§˜å¯†æš—å·â€ (`needle`)\*\* è¿›è¡Œæ·±åº¦åˆ†æåï¼Œåˆ¶ä½œå‡ºæ¥çš„â€œ**å¤±é…è¡ŒåŠ¨é¢„æ¡ˆ**â€ã€‚
  - è¿™ä»½é¢„æ¡ˆï¼Œæ˜¯å…³äº**æš—å·è‡ªèº«**çš„ç»“æ„ç‰¹æ€§çš„ï¼ˆæ¯”å¦‚æš—å·çš„å¼€å¤´å’Œç»“å°¾æœ‰å¤šé•¿çš„é‡å¤ï¼‰ã€‚

ä½ çš„ä»£ç ï¼Œç›¸å½“äºè®© KMP ç‰¹å·¥ä¸å»åˆ†ææ‰‹é‡Œçš„â€œæš—å·â€ï¼Œè€Œå»åˆ†æé‚£æœ¬åšåšçš„â€œæ•Œæ–¹ç”µæŠ¥â€ (`haystack`)ï¼Œå¹¶ä¸ºæ•´æœ¬ç”µæŠ¥åˆ¶ä½œäº†ä¸€ä»½â€œé¢„æ¡ˆâ€ã€‚è¿™ä»½é”™è¯¯çš„é¢„æ¡ˆï¼Œå¯¹äºå¯»æ‰¾â€œæš—å·â€æ¥è¯´æ˜¯å®Œå…¨æ— ç”¨çš„ã€‚

> **æ ¸å¿ƒæ²‰æ·€ç‚¹**ï¼š
> **`next` æ•°ç»„æ˜¯ KMP ç®—æ³•ä¸ºâ€œæ¨¡å¼ä¸²â€(`pattern`/`needle`)é‡èº«å®šåˆ¶çš„â€œè·³è½¬è¡¨â€ï¼Œå®ƒçš„æ„å»ºè¿‡ç¨‹åªä¸æ¨¡å¼ä¸²è‡ªèº«æœ‰å…³ï¼Œä¸å¾…æŸ¥æ‰¾çš„æ–‡æœ¬ä¸² (`text`/`haystack`) æ— å…³ã€‚**

-----

### **2. æ ¸å¿ƒè§£é¢˜æ€è·¯ï¼šKMP ç®—æ³•**

æ­¤é¢˜çš„æœ€ä¼˜è§£ä¹‹ä¸€å°±æ˜¯ KMP ç®—æ³•ï¼Œå®ƒé€šè¿‡â€œç©ºé—´æ¢æ—¶é—´â€çš„æ€æƒ³ï¼Œå®ç°äº†çº¿æ€§çš„æ—¶é—´å¤æ‚åº¦ã€‚

1.  **å¤‡è¯¾é˜¶æ®µ `buildNext(needle)`**:
    é¢„å¤„ç†â€œæ¨¡å¼ä¸²â€ `needle`ï¼Œç”Ÿæˆä¸€å¼ â€œå¤±é…è·³è½¬è¡¨â€ `next`ã€‚è¿™å¼ è¡¨è®°å½•äº† `needle` å†…éƒ¨çš„å‰åç¼€é‡å¤ä¿¡æ¯ï¼Œæ˜¯åç»­å®ç°â€œæ™ºèƒ½æ»‘åŠ¨â€çš„ä¾æ®ã€‚

2.  **åŒ¹é…é˜¶æ®µ `strStr(...)`**:
    ä½¿ç”¨åŒæŒ‡é’ˆ `i` (æ–‡æœ¬ä¸²) å’Œ `j` (æ¨¡å¼ä¸²) è¿›è¡ŒåŒ¹é…ã€‚å½“é‡åˆ°ä¸åŒ¹é…æ—¶ï¼Œ`i` æŒ‡é’ˆä¸å›æº¯ï¼Œè€Œæ˜¯é€šè¿‡æŸ¥è¯¢ `next` è¡¨æ¥æ™ºèƒ½åœ°â€œæ»‘åŠ¨â€ `j` æŒ‡é’ˆï¼Œè·³è¿‡å¤§é‡ä¸å¿…è¦çš„æ¯”è¾ƒã€‚

-----

### **3. æœ€ä¼˜è§£ä»£ç  (KMP å®ç°)**

```java
class Solution {
    public int strStr(String haystack, String needle) {
        if (needle == null || needle.length() == 0) {
            return 0;
        }
        if (haystack == null || haystack.length() < needle.length()) {
            return -1;
        }

        int m = haystack.length(); // æ¯ä¸² (text)
        int n = needle.length();   // å­ä¸² (pattern)

        // 1. ã€æ­£ç¡®ã€‘: next æ•°ç»„å¿…é¡»æ ¹æ®â€œæ¨¡å¼ä¸²â€ needle æ¥æ„å»ºï¼
        int[] next = buildNext(needle); 

        // 2. è¿›è¡ŒåŒ¹é…
        for (int i = 0, j = 0; i < m; i++) {
            // é‡åˆ°ä¸åŒ¹é…æ—¶ï¼Œåˆ©ç”¨ next æ•°ç»„å›é€€ j æŒ‡é’ˆ
            while (j > 0 && haystack.charAt(i) != needle.charAt(j)) {
                j = next[j - 1];
            }

            // å¦‚æœå½“å‰å­—ç¬¦åŒ¹é…ï¼Œj æŒ‡é’ˆå‰è¿›
            if (haystack.charAt(i) == needle.charAt(j)) {
                j++;
            }

            // å¦‚æœ j èµ°åˆ°äº†æ¨¡å¼ä¸²çš„æœ«å°¾ï¼Œè¯´æ˜å®Œå…¨åŒ¹é…
            if (j == n) {
                return i - n + 1; // è¿”å›åŒ¹é…çš„èµ·å§‹ä½ç½®
            }
        }
        
        return -1;
    }
    
    // KMP çš„æ ¸å¿ƒè¾…åŠ©æ–¹æ³•ï¼šæ„å»º next æ•°ç»„
    private int[] buildNext(String needle) {
        int m = needle.length();
        int[] next = new int[m];
        if (m == 0) return next;
        next[0] = 0;

        for (int i = 1, j = 0; i < m; i++) {
            while (j > 0 && needle.charAt(i) != needle.charAt(j)) {
                j = next[j - 1];
            }
            if (needle.charAt(i) == needle.charAt(j)) {
                j++;
            }
            next[i] = j;
        }
        return next;
    }
}
```

-----

### **4. æ€»ç»“ä¸æ²‰æ·€å¡ç‰‡**

-----

### ğŸ“ LeetCode æ²‰æ·€å¡ç‰‡

  - **é¢˜å·ä¸æ ‡é¢˜**: [28. æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡ (Find the Index of the First Occurrence in a String)](https://leetcode.cn/problems/find-the-index-of-the-first-occurrence-in-a-string/)

  - **æ ¸å¿ƒæ€æƒ³**: åˆ©ç”¨ KMP ç®—æ³•ï¼Œé€šè¿‡å¯¹â€œæ¨¡å¼ä¸²â€ (`needle`) è¿›è¡Œé¢„å¤„ç†ç”Ÿæˆ `next` æ•°ç»„ï¼Œç„¶ååœ¨éå†â€œæ–‡æœ¬ä¸²â€ (`haystack`) æ—¶å®ç°é«˜æ•ˆçš„ã€ä¸å›æº¯çš„åŒ¹é…ã€‚

  - **å…³é”®æŠ€å·§**: **`next` æ•°ç»„çš„åº”ç”¨**ã€‚

    1.  **æ„å»º (`buildNext`)**: `next[i]` å­˜å‚¨çš„æ˜¯ `pattern[0...i]` çš„æœ€é•¿ç›¸ç­‰å‰åç¼€çš„é•¿åº¦ã€‚è¿™æ˜¯â€œæ¨¡å¼ä¸²â€çš„è‡ªæˆ‘åˆ†æã€‚
    2.  **ä½¿ç”¨ (`strStr`)**: å½“ `text[i]` å’Œ `pattern[j]` å¤±é…æ—¶ï¼Œ`i` æŒ‡é’ˆä¸å›é€€ï¼Œ`j` æŒ‡é’ˆæ ¹æ® `next[j-1]` çš„å€¼è¿›è¡Œâ€œæ™ºèƒ½è·³è½¬â€ï¼Œä»è€Œè·³è¿‡æ— æ•ˆçš„æ¯”è¾ƒã€‚
    3.  **ï¼ˆæœ¬æ¬¡çŠ¯é”™çš„å…³é”®æ²‰æ·€ç‚¹ï¼‰**: **`next` æ•°ç»„æ°¸è¿œæ˜¯æ ¹æ® `pattern` (`needle`) æ„å»ºçš„ï¼Œè€Œä¸æ˜¯ `text` (`haystack`)**ã€‚

  - **å¤æ‚åº¦åˆ†æ**: (`m` = haystack é•¿åº¦, `n` = needle é•¿åº¦)

      - **æš´åŠ›è§£ (Naive Search)**ï¼šTime $O(m \\cdot n)$, Space $O(1)$
      - **KMP è§£æ³•**ï¼šTime $O(m + n)$, Space $O(n)$ (ç”¨äº `next` æ•°ç»„)

  - **åŒç±»é¢˜å‹**:

      - [LeetCode 1392. æœ€é•¿å¿«ä¹å‰ç¼€](https://leetcode.cn/problems/longest-happy-prefix/): è¿™é“é¢˜çš„é¢˜æ„ï¼Œå°±æ˜¯è®©ä½ å®ç° `buildNext` æ–¹æ³•ï¼Œå¹¶è¿”å› `next[n-1]`ï¼Œæ˜¯ KMP é¢„å¤„ç†é˜¶æ®µçš„ç›´æ¥åº”ç”¨ã€‚
      - [LeetCode 459. é‡å¤çš„å­å­—ç¬¦ä¸²](https://leetcode.cn/problems/repeated-substring-pattern/): å¯ä»¥é€šè¿‡ KMP çš„ `next` æ•°ç»„çš„æ€§è´¨æ¥å·§å¦™æ±‚è§£ã€‚

-----
